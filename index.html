
<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Vergi Avantaj HesaplayÄ±cÄ± (AraÃ§ / Motor)</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { font-family: Arial; padding: 2rem; background: #f0f2f5; }
    .container { display: flex; gap: 2rem; flex-wrap: wrap; }
    .input-panel, .chart-panel {
      background: #fff; padding: 1rem; border-radius: 8px;
      box-shadow: 0 0 10px #ccc;
      flex: 1 1 400px;
    }
    input, select {
      padding: 0.4rem; width: 100%; margin-bottom: 0.6rem;
    }
    label {
      font-weight: bold; display: block; margin-top: 1rem;
    }
    #sonuc p { margin: 0.4rem 0; }
    .optimum-box {
      margin-top: 1rem;
      background: #e6ffe6;
      padding: 0.8rem;
      border-left: 5px solid #28a745;
      font-weight: bold;
      border-radius: 6px;
    }
  </style>
</head>
<body>
  <h1>Åžirket AracÄ± / Motoru Vergi Avantaj HesaplayÄ±cÄ±</h1>
  <div class="container">
    <div class="input-panel">
      <label>AlÄ±m TÃ¼rÃ¼:</label>
      <select id="alimsinifi" onchange="hesapla()">
        <option value="motor">Motor</option>
        <option value="arac">AraÃ§</option>
      </select>

      <label>KDV Dahil AlÄ±ÅŸ Bedeli:</label>
      <input type="number" id="alis" value="215000" oninput="hesapla()">

      <label>SatÄ±ÅŸ Bedeli:</label>
      <input type="number" id="satis" value="132000" oninput="hesapla()">

      <label>KullanÄ±m SÃ¼resi (ay):</label>
      <input type="number" id="sure" value="18" oninput="hesapla()">

      <label>Ã–TV:</label>
      <input type="number" id="otv" value="15000" oninput="hesapla()">

      <label>MTV:</label>
      <input type="number" id="mtv" value="3000" oninput="hesapla()">

      <label>Sigorta:</label>
      <input type="number" id="sigorta" value="2500" oninput="hesapla()">

      <label>BakÄ±m Gideri:</label>
      <input type="number" id="bakim" value="4000" oninput="hesapla()">

      <div class="optimum-box" id="tavsiye"></div>
    </div>

    <div class="chart-panel">
      <div id="sonuc"></div>
      <canvas id="chart" width="400" height="300" style="margin-top:2rem;"></canvas>
    </div>
  </div>

  <script>
    let chart;

    function guncelleGrafik(veriler) {
      const ctx = document.getElementById('chart').getContext('2d');
      if (chart) chart.destroy();

      chart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: [
            "KDV",
            "Amortisman",
            "GeÃ§ici V.",
            "MTV",
            "Sigorta",
            "BakÄ±m",
            "Nakit"
          ],
          datasets: [{
            label: "Vergi AvantajÄ± (TL)",
            data: veriler,
            backgroundColor: ['#4e79a7', '#59a14f', '#f28e2b', '#e15759', '#76b7b2', '#edc948', '#af7aa1']
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: { display: false }
          }
        }
      });
    }

    function hesapla() {
      let alis = parseFloat(document.getElementById('alis').value) || 0;
      let satis = parseFloat(document.getElementById('satis').value) || 0;
      let sure = parseInt(document.getElementById('sure').value) || 0;
      let otv = parseFloat(document.getElementById('otv').value) || 0;
      let mtv = parseFloat(document.getElementById('mtv').value) || 0;
      let sigorta = parseFloat(document.getElementById('sigorta').value) || 0;
      let bakim = parseFloat(document.getElementById('bakim').value) || 0;
      let alimTipi = document.getElementById('alimsinifi').value;

      let kdvOrani = 0.20;
      let kurumVergisiOrani = 0.25;
      let faizYillik = 0.12;

      let kdvAlis = alis * kdvOrani / (1 + kdvOrani);
      let kdvSatis = satis * kdvOrani / (1 + kdvOrani);
      let kdvAvantaji = kdvAlis - kdvSatis;

      let amortismanaTabi = alis - kdvAlis;
      let oran = alimTipi === "motor" ? 0.40 : 0.20; // motor daha hÄ±zlÄ± amorti edilir
      let normalAmortisman = amortismanaTabi * 0.2 * (sure / 12);
      let hizliAmortisman = amortismanaTabi * oran + (amortismanaTabi - amortismanaTabi * oran) * oran * (sure / 12 - 1);
      let amortismanFarki = hizliAmortisman - normalAmortisman;
      let vergiAvantajiAmortisman = amortismanFarki * kurumVergisiOrani;
      let geciciVergiAvantaji = vergiAvantajiAmortisman * 0.5;

      let mtvVergi = mtv * kurumVergisiOrani;
      let sigortaVergi = sigorta * kurumVergisiOrani;
      let bakimVergi = bakim * kurumVergisiOrani;
      let kdvNakitAvantaji = kdvAlis * (faizYillik / 12);

      let toplam = kdvAvantaji + vergiAvantajiAmortisman + geciciVergiAvantaji + mtvVergi + sigortaVergi + bakimVergi + kdvNakitAvantaji;

      document.getElementById('sonuc').innerHTML = `
        <h3>DetaylÄ± Vergi AvantajlarÄ±</h3>
        <p><strong>KDV AvantajÄ±:</strong> ${kdvAvantaji.toFixed(2)} TL</p>
        <p><strong>Amortisman Vergi AvantajÄ±:</strong> ${vergiAvantajiAmortisman.toFixed(2)} TL</p>
        <p><strong>GeÃ§ici Vergi AvantajÄ±:</strong> ${geciciVergiAvantaji.toFixed(2)} TL</p>
        <p><strong>MTV Vergi AvantajÄ±:</strong> ${mtvVergi.toFixed(2)} TL</p>
        <p><strong>Sigorta Vergi AvantajÄ±:</strong> ${sigortaVergi.toFixed(2)} TL</p>
        <p><strong>BakÄ±m Gideri Vergi AvantajÄ±:</strong> ${bakimVergi.toFixed(2)} TL</p>
        <p><strong>KDV Nakit AvantajÄ±:</strong> ${kdvNakitAvantaji.toFixed(2)} TL</p>
        <hr>
        <p><strong>Toplam Vergi AvantajÄ±:</strong> <span style="font-size: 1.2rem; color: green;">${toplam.toFixed(2)} TL</span></p>
      `;

      guncelleGrafik([
        kdvAvantaji,
        vergiAvantajiAmortisman,
        geciciVergiAvantaji,
        mtvVergi,
        sigortaVergi,
        bakimVergi,
        kdvNakitAvantaji
      ]);

      // SÃ¼rpriz iÃ§erik: optimum satÄ±ÅŸ zamanÄ± tavsiyesi
      let tavsiye = "ðŸ“Œ Tavsiye: ";
      if (sure <= 12) tavsiye += "1 yÄ±ldan Ã¶nce satÄ±ÅŸ, vergi avantajÄ±nÄ± azaltabilir.";
      else if (sure <= 24) tavsiye += "SatÄ±ÅŸ iÃ§in uygun dÃ¶nem. Vergi avantajÄ± yÃ¼ksek.";
      else tavsiye += "SatÄ±ÅŸ Ã¶ncesi yeniden amortisman analizi Ã¶nerilir.";
      document.getElementById("tavsiye").innerText = tavsiye;
    }

    window.onload = hesapla;
  </script>
</body>
</html>
